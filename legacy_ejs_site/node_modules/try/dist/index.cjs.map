{"version":3,"file":"index.cjs","names":["ok","error"],"sources":["../lib/index.js"],"sourcesContent":["/// <reference path=\"./index.d.ts\" />\n\n/** @template V */\nexport class Result {\n  /**\n   * @param {boolean} ok\n   * @param {unknown} [error]\n   * @param {V} [value]\n   */\n  constructor(ok, error, value) {\n    this.ok = !!ok;\n\n    // must not set the other field to allow for\n    // 'error' in result checks\n    if (this.ok) {\n      this.value = value;\n    } else {\n      this.error = error;\n    }\n  }\n\n  *[Symbol.iterator]() {\n    yield this.ok;\n    yield this.error;\n    yield this.value;\n  }\n\n  /**\n   * @this void\n   * @template T\n   * @param {T} value\n   */\n  static ok(value) {\n    return new Result(true, undefined, value);\n  }\n\n  /**\n   * @this void\n   * @param {unknown} error\n   */\n  static error(error) {\n    return new Result(false, error);\n  }\n\n  /**\n   * @this void\n   * @template T\n   * @param {any} result\n   * @param {...any} args\n   * @returns {Promise<Result<T>> | Result<T>}\n   */\n  static try(result, ...args) {\n    // Wraps everything because `try` should never throw.\n    try {\n      // If syncFn() is passed directly, it throws before try() runs.\n      // To prevent this, wrap it in a function and unwrap its result.\n      if (typeof result === 'function') {\n        result = result.apply(undefined, args);\n      }\n\n      // Promises must return a valid Promise<Result<T>>\n      if (result instanceof Promise) {\n        return result.then(Result.ok, Result.error);\n      }\n\n      // If the result is not a function or a Promise, we can be sure its a success\n      return Result.ok(result);\n    } catch (error) {\n      return Result.error(error);\n    }\n  }\n}\n\n// Aliases\nexport const error = Result.error;\nexport const ok = Result.ok;\nexport const t = Result.try;\n"],"mappings":";;;AAGA,IAAa,SAAb,MAAa,OAAO;;;;;;CAMlB,YAAY,MAAI,SAAO,OAAO;AAC5B,OAAK,KAAK,CAAC,CAACA;AAIZ,MAAI,KAAK,GACP,MAAK,QAAQ;MAEb,MAAK,QAAQC;;CAIjB,EAAE,OAAO,YAAY;AACnB,QAAM,KAAK;AACX,QAAM,KAAK;AACX,QAAM,KAAK;;;;;;;CAQb,OAAO,GAAG,OAAO;AACf,SAAO,IAAI,OAAO,MAAM,QAAW,MAAM;;;;;;CAO3C,OAAO,MAAM,SAAO;AAClB,SAAO,IAAI,OAAO,OAAOA,QAAM;;;;;;;;;CAUjC,OAAO,IAAI,QAAQ,GAAG,MAAM;AAE1B,MAAI;AAGF,OAAI,OAAO,WAAW,WACpB,UAAS,OAAO,MAAM,QAAW,KAAK;AAIxC,OAAI,kBAAkB,QACpB,QAAO,OAAO,KAAK,OAAO,IAAI,OAAO,MAAM;AAI7C,UAAO,OAAO,GAAG,OAAO;WACjBA,SAAO;AACd,UAAO,OAAO,MAAMA,QAAM;;;;AAMhC,MAAa,QAAQ,OAAO;AAC5B,MAAa,KAAK,OAAO;AACzB,MAAa,IAAI,OAAO"}